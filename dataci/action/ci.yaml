name: text_dataset_ci
on:
  dataset_publish: raw_dataset
  stage_publish: text_aug
config:
  workflow: testspace/build_text_dataset@latest
  dataset: raw_dataset@*
  stage: text_aug@*
jobs:
  steps:
    - name: Execute Workflow
      uses: ${{ config.workflow }}
      with:
        version: ${{ config.dataset.version }}
    - name: Data Quality Check
      uses: official/data_quality_check@v1
    - name: Data-centric Benchmark
      uses: official/dc_benchmark@v1
      with:
        type: data_aug
        ml_task: text_classification
        pass_condition: metrics.acc > 0.75
    - name: Publish Dataset
      run: |
        dataci publish ${{ steps.data_centric_benchmark.outputs }}